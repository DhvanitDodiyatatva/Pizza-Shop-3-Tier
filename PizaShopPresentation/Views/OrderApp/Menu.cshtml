@{
    ViewData["Title"] = "Menu";
    Layout = "~/Views/Shared/_LayoutOrdApp.cshtml";
}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<style>
    .sidebar {
        background-color: #fff;
        padding: 15px;
        border-right: 1px solid #ddd;
        height: 100%;
        margin-left: 0px !important;
    }

    .sidebar h5 {
        font-size: 16px;
        margin-bottom: 10px;
        color: #333;
    }

    .list-group-item {
        border: none;
        padding: 8px 15px;
        background: none;
    }

    .list-group-item.active {
        background-color: #1f73ae;
        color: #fff;
        border-radius: 10px 50px 50px 10px;
    }

    .list-group-item a {
        color: #333;
        text-decoration: none;
    }

    .list-group-item.active a {
        color: #fff;
    }

    .main-content {
        padding: 15px;
        height: 100%;
    }

    .search-bar {
        padding: 10px;
        margin-bottom: 15px;
    }

    .search-bar input {
        border: none;
        background: #fff;
        padding: 5px 10px;
        border-radius: 5px;
    }

    .search-bar button {
        border: none;
        background: none;
        cursor: pointer;
    }

    .badge {
        width: 25px;
        height: 25px;
        border-radius: 0px 5px 0px 200px;
        padding: 0;
    }

    @* .item-type {
        display: flex;
        align-items: center;
    } *@

    .item-card {
        display: inline-block;
        width: 18rem;
        height: 60px;
        margin: 10px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        text-align: center;
        position: relative;
        padding: 10px;
        border: 1px solid #ddd;
    }

    .item-card .card-title {
        font-size: 14px;
        margin: 0;
        color: #333;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .item-card .card-text {
        font-size: 12px;
        color: #666;
        margin: 5px 0;
    }

    .heart {
        position: absolute !important;
        bottom: -5px !important;
        right: 0px !important;
        font-size: 18px;
        color: #ccc;
        cursor: pointer;
    }

    .heart:hover {
        color: #1f73ae;
    }
</style>

<div class="container-fluid p-0">

    <div class="row m-0 p-0">
        <!-- Category List Container -->
        <div class="col-md-2 p-0">
            <div style="overflow: auto; height: 100%;" class="custom-scrollbar" id="categoryContainer">
                <!-- Categories loaded here via AJAX -->
            </div>
        </div>

        <!-- Item List Container -->
        <div class="col-md-5 p-0">
            <div style="overflow: auto; height: 91dvh;" class="custom-scrollbar" id="itemListContainer">
                <!-- Items loaded here via AJAX -->
            </div>
        </div>

        <div class="col-md-5 p-0">
            <div class="card  mt-5 mx-5 border-0 shadow-sm" style="border-radius: 15px;">
                <div class="card-body p-3">
                    <!-- Table Info -->
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <div class="text-muted">
                            <img src="~/images/dashboard/tableandSection.png" class="ps-1 pe-2"
                                style="height: 40px; width:40px; background-color: #6eb7eb;"><span class="fw-bold"
                                style="margin-left: 15px;">First Floor <p style="margin-left: 54px; margin-top: -10px;"
                                    class="me-2">Table: T2, T6</p>
                            </span>
                        </div>
                        <div class="d-flex align-items-center">
                            <button class="btn btn-outline-primary me-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                                    class="bi bi-qr-code-scan" viewBox="0 0 16 16">
                                    <path
                                        d="M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5M.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5m15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5M4 4h1v1H4z" />
                                    <path d="M7 2H2v5h5zM3 3h3v3H3zm2 8H4v1h1z" />
                                    <path d="M7 9H2v5h5zm-4 1h3v3H3zm8-6h1v1h-1z" />
                                    <path
                                        d="M9 2h5v5H9zm1 1v3h3V3zM8 8v2h1v1H8v1h2v-2h1v2h1v-1h2v-1h-3V8zm2 2H9V9h1zm4 2h-1v1h-2v1h3zm-4 2v-1H8v1z" />
                                    <path d="M12 9h2V8h-2z" />
                                </svg>
                            </button>
                            <button class="btn btn-outline-primary me-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                                    class="bi bi-person-lines-fill" viewBox="0 0 16 16">
                                    <path
                                        d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z" />
                                </svg>
                            </button>
                            <button class="btn btn-outline-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                                    class="bi bi-chat-left-text" viewBox="0 0 16 16">
                                    <path
                                        d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z" />
                                    <path
                                        d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Headers for Item, Quantity, Amount -->
                    <div class="d-flex  align-items-center mb-1 row">
                        <div class="col-6 fw-bold text-start" style="text-align: center;">Item</div>
                        <div class=" col-3 fw-bold" style="width: 100px;  text-align: center;">Quantity</div>
                        <div class="col-3 fw-bold" style="width: 100px; text-align: center;">Amount</div>
                    </div>

                    <!-- Accordion for Items -->
                    <div class="accordion mb-2 custom-scrollbar" id="cartAccordion"
                        style="max-height: 260px; min-height: 250px; overflow-y: auto; overflow-x: hidden;">
                        <!-- Item 1: Margherita -->
                        <div class="accordion mt-1" id="itemAccordian-1-1-margherita">
                            <div class="accordion-item d-flex justify-content-between text-secondary mb-2 mt-1">
                                <div class="d-flex flex-column">
                                    <div class="accordion-header text-secondary d-flex fw-bolder align-items-center">
                                        <div class="d-flex align-items-center">
                                            <button
                                                class="accordion-button pe-1 ps-2 text-secondary fw-bolder rounded-2 collapsed"
                                                type="button" data-bs-toggle="collapse"
                                                data-bs-target="#collapse-1-1-margherita"
                                                aria-controls="collapse-1-1-margherita">
                                            </button>
                                            <div class="item-name-order-card" data-globalId="margherita"
                                                data-orderedItemId="1">
                                                <div class="text-truncate" style="max-width:150px;">Margherita</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="collapse-1-1-margherita" class="accordion-collapse collapse"
                                        data-bs-parent="#itemAccordian-1-1-margherita">
                                        <div class="accordion-body">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span>Onion</span>
                                                <span>â‚¹20.00</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-4 me-3 align-items-center">
                                    <div class="d-flex align-items-center gap-2 border border-secondary rounded px-2 py-1 quantity-selector text-secondary justify-content-between"
                                        style="width:100px">
                                        <button class="btn btn-sm border-0 bg-transparent minus px-2 py-1"
                                            data-itemId="1" data-globalId="margherita">-</button>
                                        <div class="count">1</div>
                                        <button class="btn btn-sm border-0 bg-transparent plus px-2 py-1"
                                            data-itemId="1" data-globalId="margherita">+</button>
                                    </div>
                                    <div style="width:100px;">
                                        <span class="fs-5">â‚¹120.00</span><br>
                                        <span>â‚¹20.00</span>
                                    </div>
                                    <a class="btn border-0 p-0" id="deleteItem" data-globalId="margherita">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                            fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                            <path
                                                d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5" />
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- Item 2: Aaloo Sandwich -->
                        <div class="accordion mt-1" id="itemAccordian-2-1-aaloo">
                            <div class="accordion-item d-flex justify-content-between text-secondary mb-2 mt-1">
                                <div class="d-flex flex-column">
                                    <div class="accordion-header text-secondary d-flex fw-bolder align-items-center">
                                        <div class="d-flex align-items-center">
                                            <button
                                                class="accordion-button pe-1 ps-2 text-secondary fw-bolder rounded-2 collapsed"
                                                type="button" data-bs-toggle="collapse"
                                                data-bs-target="#collapse-2-1-aaloo" aria-controls="collapse-2-1-aaloo">
                                            </button>
                                            <div class="item-name-order-card" data-globalId="aaloo"
                                                data-orderedItemId="2">
                                                <div class="text-truncate" style="max-width:150px;">Aaloo Sandwich</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="collapse-2-1-aaloo" class="accordion-collapse collapse"
                                        data-bs-parent="#itemAccordian-2-1-aaloo">
                                        <div class="accordion-body">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span>Mushroom</span>
                                                <span>â‚¹50.00</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-4 me-3 align-items-center">
                                    <div class="d-flex align-items-center gap-2 border border-secondary rounded px-2 py-1 quantity-selector text-secondary justify-content-between"
                                        style="width:100px">
                                        <button class="btn btn-sm border-0 bg-transparent minus px-2 py-1"
                                            data-itemId="2" data-globalId="aaloo">-</button>
                                        <div class="count">1</div>
                                        <button class="btn btn-sm border-0 bg-transparent plus px-2 py-1"
                                            data-itemId="2" data-globalId="aaloo">+</button>
                                    </div>
                                    <div style="width:100px;">
                                        <span class="fs-5">â‚¹120.00</span><br>
                                        <span>â‚¹50.00</span>
                                    </div>
                                    <a class="btn border-0 p-0" id="deleteItem" data-globalId="aaloo">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                            fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                            <path
                                                d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5" />
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- Item 3: Capsicum -->
                        <div class="accordion mt-1" id="itemAccordian-3-3-capsicum">
                            <div class="accordion-item d-flex justify-content-between text-secondary mb-2 mt-1">
                                <div class="d-flex flex-column">
                                    <div class="accordion-header text-secondary d-flex fw-bolder align-items-center">
                                        <div class="d-flex align-items-center">
                                            <button
                                                class="accordion-button pe-1 ps-2 text-secondary fw-bolder rounded-2 collapsed"
                                                type="button" data-bs-toggle="collapse"
                                                data-bs-target="#collapse-3-3-capsicum"
                                                aria-controls="collapse-3-3-capsicum">
                                            </button>
                                            <div class="item-name-order-card" data-globalId="capsicum"
                                                data-orderedItemId="3">
                                                <div class="text-truncate" style="max-width:150px;">Capsicum</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="collapse-3-3-capsicum" class="accordion-collapse collapse"
                                        data-bs-parent="#itemAccordian-3-3-capsicum">
                                        <div class="accordion-body">
                                            <div class="d-flex justify-content-between align-items-center mb-2">
                                                <span>Onion</span>
                                                <span>â‚¹20.00</span>
                                            </div>
                                            <div class="d-flex justify-content-between align-items-center mb-2">
                                                <span>Pepperoni</span>
                                                <span>â‚¹500.00</span>
                                            </div>
                                            <div class="d-flex justify-content-between align-items-center mb-2">
                                                <span>Peper</span>
                                                <span>â‚¹150.00</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-4 me-3 align-items-center">
                                    <div class="d-flex align-items-center gap-2 border border-secondary rounded px-2 py-1 quantity-selector text-secondary justify-content-between"
                                        style="width:100px">
                                        <button class="btn btn-sm border-0 bg-transparent minus px-2 py-1"
                                            data-itemId="3" data-globalId="capsicum">-</button>
                                        <div class="count">1</div>
                                        <button class="btn btn-sm border-0 bg-transparent plus px-2 py-1"
                                            data-itemId="3" data-globalId="capsicum">+</button>
                                    </div>
                                    <div style="width:100px;">
                                        <span class="fs-5">â‚¹800.00</span><br>
                                        <span>â‚¹670.00</span>
                                    </div>
                                    <a class="btn border-0 p-0" id="deleteItem" data-globalId="capsicum">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                            fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                            <path
                                                d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5" />
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Subtotal and Taxes -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between">
                            <span>SUBTOTAL</span>
                            <span>â‚¹1780.00</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>CGST</span>
                            <span>â‚¹213.60</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>GST</span>
                            <span>â‚¹35.00</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Other</span>
                            <span>â‚¹69.00</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span><input type="checkbox" class="checkbox">SGST</span>
                            <span></span>
                        </div>
                        <div class="d-flex justify-content-between fw-bold">
                            <span>TOTAL</span>
                            <span>â‚¹2118.20</span>
                        </div>
                    </div>

                    <!-- Payment Method -->
                    <div class="mb-3 d-flex justify-content-between">
                        <div><label class="form-label">Payment Method</label></div>
                        <div class="d-flex">
                            <div class="form-check me-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="cash" checked>
                                <label class="form-check-label" for="cash">Cash</label>
                            </div>
                            <div class="form-check me-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="card">
                                <label class="form-check-label" for="card">Card</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="upi">
                                <label class="form-check-label" for="upi">UPI</label>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between ">
                        <button class="btn btn-primary">Save</button>
                        <button class="btn btn-outline-primary">Complete</button>
                        <button class="btn btn-outline-primary">Generate Invoice</button>
                        <button class="btn btn-outline-secondary">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let currentCategory = 'All'; // Track the current category

    function loadCategories() {
        $.ajax({
            url: '@Url.Action("GetCategories", "OrderApp")',
            type: 'GET',
            success: function (result) {
                $("#categoryContainer").html(result);
                $(".category-link").on("click", function (e) {
                    e.preventDefault();
                    $(".list-group-item").removeClass("active");
                    $(this).closest(".list-group-item").addClass("active");
                    currentCategory = $(this).data("category-name") || 'All';
                    loadItems(currentCategory, '');
                });
            },
            error: function (xhr, status, error) {
                console.error("Error loading categories:", error);
            }
        });
    }

    function loadItems(category, search) {
        $.ajax({
            url: '@Url.Action("GetItems", "OrderApp")',
            type: 'GET',
            data: {
                category: category || 'All',
                search: search || ''
            },
            success: function (result) {
                $("#itemListContainer").html(result);
            },
            error: function (xhr, status, error) {
                console.error("Error loading items:", error);
            }
        });
    }

    $(document).ready(function () {
        loadCategories();
        loadItems('All', '');

        // Handle dynamic search
        $(document).on("input", "#searchInput", function () {
            const searchTerm = $(this).val();
            loadItems(currentCategory, searchTerm);
        });
    });
</script>

@* fafvgdfvgsvsdvg *@
